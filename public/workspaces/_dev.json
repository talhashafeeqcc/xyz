{
  "title": "GEOLYTIX | XYZ DEV",
  "templates": {
      "population_summary": {
          "template": "https://api.github.com/repos/GEOLYTIX/xyz_resources/contents/dev/queries/_population_summary",
          "dbs": "XYZ"
      },
      "table_view": {
        "template": "http://localhost:3000/views/table_view.html"
      }
  },
  "locales": {
      "UK": {
          "name": "United Kingdom",
          "gazetteer": {
              "provider": "GOOGLE",
              "code": "GB",
              "placeholder": "eg. London"
          },
          "bounds": {
              "north": 62,
              "east": 5,
              "south": 49,
              "west": -13
          },
          "minZoom": 2,
          "maxZoom": 17,
          "showScaleBar": true,
          "layers": {
              "Mapbox Custom": {
                  "group": "Maps",
                  "format": "tiles",
                  "URI": "/styles/v1/dbauszus/ck440j2d20nmd1coafctud8tl/tiles/256/{z}/{x}/{y}?&provider=MAPBOX&host=https://api.mapbox.com",
                  "display": true,
                  "attribution": {
                      "© Mapbox": "https://www.mapbox.com/about/maps",
                      "© OpenStreetMap": "http://www.openstreetmap.org/copyright"
                  }
              },
              "Mapbox Labels": {
                  "group": "Maps",
                  "display": false,
                  "format": "tiles",
                  "URI": "/styles/v1/dbauszus/cj9puo8pr5o0c2sovhdwhkc7z/tiles/256/{z}/{x}/{y}?&provider=MAPBOX&host=https://api.mapbox.com",
                  "attribution": {
                      "© Mapbox": "https://www.mapbox.com/about/maps",
                      "© OpenStreetMap": "http://www.openstreetmap.org/copyright"
                  }
              },
              "Small Cluster": {
                  "group": "Point layers",
                  "meta": "Large Supermarkets - contains 1,500 records - kmeans and dbscan",
                  "display": false,
                  "format": "cluster",
                  "dbs": "DEV",
                  "table": "dev.uk_glx_open_retail_points_large_supermarkets",
                  "qID": "id",
                  "geom": "geom_p_4326",
                  "srid": "4326",
                  "cluster_label": "fascia",
                  "cluster_cat": "retailer",
                  "cluster_kmeans": 0.02,
                  "cluster_dbscan": 0.02,
                  "hover": {
                      "field": "store_name"
                  },
                  "dataview": {
                      "Large Supermarkets": {
                          "display": true,
                          "from": "dev.uk_glx_open_retail_points_large_supermarkets",
                          "columns": [
                              {
                                  "field": "id",
                                  "title": "ID"
                              },
                              {
                                  "field": "store_name",
                                  "title": "Store Name"
                              },
                              {
                                  "field": "town",
                                  "title": "Town"
                              },
                              {
                                  "field": "postcode",
                                  "title": "Postcode"
                              },
                              {
                                  "field": "open_date",
                                  "title": "Open Date"
                              }
                          ]
                      }
                  },
                  "infoj": [
                      {
                          "type": "key"
                      },
                      {
                          "type": "report",
                          "class": "_report",
                          "report": {
                              "template": "https://api.github.com/repos/GEOLYTIX/xyz_resources/contents/dev/new_server/map_view.html",
                              "name": "Map View"
                          }
                      },
                      {
                          "field": "retailer",
                          "label": "Retailer",
                          "inline": true
                      },
                      {
                          "field": "fascia",
                          "label": "Fascia",
                          "inline": true
                      },
                      {
                          "field": "store_name",
                          "label": "Name",
                          "inline": true
                      },
                      {
                          "label": "Address",
                          "type": "label"
                      },
                      {
                          "field": "add_one"
                      },
                      {
                          "field": "add_two"
                      },
                      {
                          "field": "locality"
                      },
                      {
                          "field": "postcode"
                      },
                      {
                          "field": "town"
                      },
                      {
                          "field": "pqi",
                          "label": "PQI"
                      },
                      {
                          "field": "open_date",
                          "label": "Open Date"
                      },
                      {
                          "field": "close_date",
                          "label": "Close Date"
                      },
                      {
                          "label": "Available dataviews",
                          "type": "label"
                      },
                      {
                          "type": "orderedList",
                          "title": "Nearest Large Supermarkets",
                          "display": true,
                          "layout": "fitColumns",
                          "from": "dev.uk_glx_open_retail_points_large_supermarkets a, dev.uk_glx_open_retail_points_large_supermarkets b",
                          "where": "a.id = $1 and a.id <> b.id",
                          "orderby": "ST_DistanceSphere(a.geom_p_4326, b.geom_p_4326)",
                          "limit": 10,
                          "columns": [
                              {
                                  "title": "ID",
                                  "field": "id",
                                  "fieldfx": "b.id"
                              },
                              {
                                  "title": "Name",
                                  "field": "store_name",
                                  "fieldfx": "b.store_name",
                                  "width": 250
                              },
                              {
                                  "title": "Postcode",
                                  "field": "postcode",
                                  "fieldfx": "b.postcode"
                              },
                              {
                                  "title": "Open Date",
                                  "field": "open_date",
                                  "fieldfx": "b.open_date"
                              },
                              {
                                  "title": "Distance",
                                  "field": "dist",
                                  "fieldfx": "ST_DistanceSphere(a.geom_p_4326, b.geom_p_4326) / 1000",
                                  "align": "center",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 1,
                                      "symbol": " km",
                                      "symbolAfter": true
                                  }
                              }
                          ]
                      },
                      {
                          "type": "streetview"
                      }
                  ],
                  "style": {
                      "label": {
                          "field": "store_name",
                          "display": false,
                          "declutter": true,
                          "strokeColor": "#ffffff",
                          "strokeWidth": 3
                      },
                      "marker": {
                          "type": "target",
                          "fillColor": "#d3d3d3"
                      },
                      "markerMulti": {
                          "type": "target",
                          "fillColor": "#93827F"
                      },
                      "markerMin": 50,
                      "markerMax": 50,
                      "highlight": {
                          "scale": 0.08
                      },
                      "themes": {
                          "Retailers": {
                              "type": "categorized",
                              "field": "retailer",
                              "other": true,
                              "cat": {
                                  "Asda": {
                                      "svg": "https://cdn.jsdelivr.net/gh/GEOLYTIX/MapIcons@master/brands/asda.svg",
                                      "anchor": [
                                          0.5,
                                          0.95
                                      ]
                                  },
                                  "Morrisons": {
                                      "svg": "https://cdn.jsdelivr.net/gh/GEOLYTIX/MapIcons@master/brands/morrisons.svg",
                                      "anchor": [
                                          0.5,
                                          0.95
                                      ]
                                  },
                                  "Sainsburys": {
                                      "label": "Sainsbury's",
                                      "svg": "https://cdn.jsdelivr.net/gh/GEOLYTIX/MapIcons@master/brands/sainsbury.svg",
                                      "anchor": [
                                          0.5,
                                          0.95
                                      ]
                                  },
                                  "Tesco": {
                                      "svg": "https://cdn.jsdelivr.net/gh/GEOLYTIX/MapIcons@master/brands/tesco.svg",
                                      "anchor": [
                                          0.5,
                                          0.95
                                      ]
                                  },
                                  "Waitrose": {
                                      "svg": "https://cdn.jsdelivr.net/gh/GEOLYTIX/MapIcons@master/brands/waitrose.svg",
                                      "anchor": [
                                          0.5,
                                          0.95
                                      ]
                                  }
                              }
                          }
                      }
                  }
              },
              "Large Cluster": {
                  "group": "Point layers",
                  "meta": "Food Stores (top 6 retailers) - contains 9,000 records - kmeans only",
                  "display": false,
                  "format": "cluster",
                  "dbs": "DEV",
                  "table": "dev.uk_glx_open_retail_points_food_stores",
                  "qID": "id",
                  "geom": "geom_p_4326",
                  "srid": "4326",
                  "cluster_label": "fascia",
                  "cluster_cat": "retailer",
                  "cluster_kmeans": 0.04,
                  "hover": {
                      "field": "store_name"
                  },
                  "infoj": [
                      {
                          "type": "key"
                      },
                      {
                          "field": "retailer",
                          "label": "Retailer",
                          "inline": true
                      },
                      {
                          "field": "fascia",
                          "label": "Fascia",
                          "inline": true
                      },
                      {
                          "field": "store_name",
                          "label": "Name",
                          "inline": true
                      },
                      {
                          "label": "Address",
                          "type": "label"
                      },
                      {
                          "field": "add_one"
                      },
                      {
                          "field": "add_two"
                      },
                      {
                          "field": "locality"
                      },
                      {
                          "field": "postcode"
                      },
                      {
                          "field": "town"
                      },
                      {
                          "field": "pqi",
                          "label": "PQI"
                      },
                      {
                          "field": "open_date",
                          "label": "Open Date"
                      },
                      {
                          "field": "close_date",
                          "label": "Close Date"
                      },
                      {
                          "label": "Available dataviews",
                          "type": "label"
                      },
                      {
                          "type": "orderedList",
                          "title": "Nearest Competitors - all stores",
                          "display": true,
                          "layout": "fitColumns",
                          "from": "dev.uk_glx_open_retail_points_food_stores a, geodata.uk_glx_open_retail_points b",
                          "where": "a.id = $1 and a.id <> b.id",
                          "orderby": "ST_DistanceSphere(a.geom_p_4326, b.geom_p_4326)",
                          "limit": 10,
                          "columns": [
                              {
                                  "title": "ID",
                                  "field": "id",
                                  "fieldfx": "b.id"
                              },
                              {
                                  "title": "Name",
                                  "field": "store_name",
                                  "fieldfx": "b.store_name",
                                  "width": 250
                              },
                              {
                                  "title": "Postcode",
                                  "field": "postcode",
                                  "fieldfx": "b.postcode"
                              },
                              {
                                  "title": "Open Date",
                                  "field": "open_date",
                                  "fieldfx": "b.open_date"
                              },
                              {
                                  "title": "Distance",
                                  "field": "dist",
                                  "fieldfx": "ST_DistanceSphere(a.geom_p_4326, b.geom_p_4326) / 1000",
                                  "align": "center",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 1,
                                      "symbol": " km",
                                      "symbolAfter": true
                                  }
                              }
                          ]
                      },
                      {
                          "label": "Catchments",
                          "type": "label",
                          "title": "Customer catchment"
                      },
                      {
                          "name": "Catchment",
                          "field": "primary_catchment",
                          "fieldfx": "ST_asGeoJson(catchment_5km)",
                          "level": 1,
                          "type": "geometry",
                          "style": {
                              "strokeWidth": 2,
                              "fillOpacity": 0.8
                          }
                      },
                      {
                          "label": "Drivetimes",
                          "type": "label"
                      },
                      {
                          "name": "HERE drivetime 5 min",
                          "field": "isoline_5min",
                          "fieldfx": "ST_asGeoJson(isoline_5min)",
                          "type": "geometry",
                          "class": "hidden_in_report",
                          "display": false,
                          "level": 2,
                          "edit": {
                              "isoline_here": {
                                  "minutes": 5
                              }
                          },
                          "style": {
                              "strokeColor": "#BB0A21",
                              "fillColor": "#BB0A21",
                              "fillOpacity": 0.3
                          }
                      },
                      {
                          "label": "Food Stores within 5min",
                          "type": "group",
                          "chart": {
                              "type": "horizontalBar",
                              "maxRotationX": 90,
                              "minRotationX": 90,
                              "beginAtZero": true,
                              "backgroundColor": [
                                  "#66cc66",
                                  "#0099ff",
                                  "#e6e600",
                                  "#e68a00",
                                  "#0000ff",
                                  "#00802b"
                              ],
                              "borderColor": [
                                  "#66cc66",
                                  "#0099ff",
                                  "#e6e600",
                                  "#e68a00",
                                  "#0000ff",
                                  "#00802b"
                              ]
                          }
                      },
                      {
                          "group": "Food Stores within 5min",
                          "label": "Asda",
                          "field": "_asda5min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Asda' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_5min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 5min",
                          "label": "Co-op",
                          "field": "_coop5min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Co-op' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_5min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 5min",
                          "label": "Morrisons",
                          "field": "_morrisons5min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Morrisons' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_5min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 5min",
                          "label": "Sainsburys",
                          "field": "_sainsburys5min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Sainsburys' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_5min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 5min",
                          "label": "Tesco",
                          "field": "_tesco5min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Tesco' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_5min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 5min",
                          "label": "Waitrose",
                          "field": "_waitrose5min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Waitrose' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_5min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "name": "HERE drivetime 10 min",
                          "field": "isoline_10min",
                          "fieldfx": "ST_asGeoJson(isoline_10min)",
                          "type": "geometry",
                          "class": "hidden_in_report",
                          "display": false,
                          "level": 2,
                          "edit": {
                              "isoline_here": {
                                  "minutes": 10
                              }
                          },
                          "style": {
                              "strokeColor": "#F49D37",
                              "fillColor": "#F49D37",
                              "fillOpacity": 0.3,
                              "strokeWidth": 2
                          }
                      },
                      {
                          "label": "Food Stores within 10min",
                          "type": "group",
                          "chart": {
                              "type": "horizontalBar",
                              "maxRotationX": 90,
                              "minRotationX": 90,
                              "beginAtZero": true,
                              "backgroundColor": [
                                  "#66cc66",
                                  "#0099ff",
                                  "#e6e600",
                                  "#e68a00",
                                  "#0000ff",
                                  "#00802b"
                              ],
                              "borderColor": [
                                  "#66cc66",
                                  "#0099ff",
                                  "#e6e600",
                                  "#e68a00",
                                  "#0000ff",
                                  "#00802b"
                              ]
                          }
                      },
                      {
                          "group": "Food Stores within 10min",
                          "label": "Asda",
                          "field": "_asda10min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Asda' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_10min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 10min",
                          "label": "Co-op",
                          "field": "_coop10min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Co-op' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_10min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 10min",
                          "label": "Morrisons",
                          "field": "_morrisons10min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Morrisons' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_10min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 10min",
                          "label": "Sainsburys",
                          "field": "_sainsburys10min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Sainsburys' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_10min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 10min",
                          "label": "Tesco",
                          "field": "_tesco10min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Tesco' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_10min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 10min",
                          "label": "Waitrose",
                          "field": "_waitrose10min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Waitrose' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_10min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "name": "HERE drivetime 15 min",
                          "field": "isoline_15min",
                          "fieldfx": "ST_asGeoJson(isoline_15min)",
                          "type": "geometry",
                          "class": "hidden_in_report",
                          "display": false,
                          "level": 2,
                          "edit": {
                              "isoline_here": {
                                  "minutes": 15
                              }
                          },
                          "style": {
                              "strokeColor": "#FFF05A",
                              "fillColor": "#FFF05A",
                              "strokeWidth": 2,
                              "fillOpacity": 0.3
                          }
                      },
                      {
                          "label": "Food Stores within 15min",
                          "type": "group",
                          "chart": {
                              "type": "horizontalBar",
                              "maxRotationX": 90,
                              "minRotationX": 90,
                              "beginAtZero": true,
                              "backgroundColor": [
                                  "#66cc66",
                                  "#0099ff",
                                  "#e6e600",
                                  "#e68a00",
                                  "#0000ff",
                                  "#00802b"
                              ],
                              "borderColor": [
                                  "#66cc66",
                                  "#0099ff",
                                  "#e6e600",
                                  "#e68a00",
                                  "#0000ff",
                                  "#00802b"
                              ]
                          }
                      },
                      {
                          "group": "Food Stores within 15min",
                          "label": "Asda",
                          "field": "_asda15min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Asda' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_15min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 15min",
                          "label": "Co-op",
                          "field": "_coop15min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Co-op' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_15min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 15min",
                          "label": "Morrisons",
                          "field": "_morrisons15min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Morrisons' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_15min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 15min",
                          "label": "Sainsburys",
                          "field": "_sainsburys15min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Sainsburys' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_15min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 15min",
                          "label": "Tesco",
                          "field": "_tesco15min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Tesco' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_15min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "group": "Food Stores within 15min",
                          "label": "Waitrose",
                          "field": "_waitrose15min",
                          "fieldfx": "SELECT coalesce(sum(case when b.retailer = 'Waitrose' then 1 else 0 end), 0) FROM dev.uk_glx_open_retail_points_food_stores a, dev.uk_glx_open_retail_points_food_stores b WHERE a.id = $1 AND st_intersects(a.isoline_15min, b.geom_p_4326) and a.id <> b.id",
                          "type": "integer"
                      },
                      {
                          "type": "streetview"
                      }
                  ],
                  "style": {
                      "label": {
                          "field": "store_name",
                          "display": false,
                          "declutter": true,
                          "strokeColor": "#ffffff",
                          "strokeWidth": 3
                      },
                      "marker": {
                          "type": "target",
                          "fillColor": "#d3d3d3"
                      },
                      "markerMulti": {
                          "type": "target",
                          "fillColor": "#93827F"
                      },
                      "themes": {
                          "Retailers": {
                              "type": "categorized",
                              "field": "retailer",
                              "other": true,
                              "cat": {
                                  "Asda": {
                                      "style": {
                                          "fillColor": "#83b923",
                                          "layers": {
                                              "0.5": "#ffffff",
                                              "0.375": "#fdb839"
                                          }
                                      }
                                  },
                                  "Co-op": {
                                      "label": "The Co-Operative",
                                      "style": {
                                          "fillColor": "#0b1e60",
                                          "layers": {
                                              "0.625": "#ffffff",
                                              "0.5": "#a3d227"
                                          }
                                      }
                                  },
                                  "Morrisons": {
                                      "style": {
                                          "fillColor": "#ffe133",
                                          "layers": {
                                              "0.5": "#00614e"
                                          }
                                      }
                                  },
                                  "Sainsburys": {
                                      "style": {
                                          "fillColor": "#ee8a00",
                                          "layers": {
                                              "0.625": "#ffffff",
                                              "0.325": "#ee8a00"
                                          }
                                      }
                                  },
                                  "Tesco": {
                                      "style": {
                                          "fillColor": "#0055a8",
                                          "layers": {
                                              "0.75": "#ffffff",
                                              "0.325": "#f02f26"
                                          }
                                      }
                                  },
                                  "Waitrose": {
                                      "style": {
                                          "fillColor": "#81ae37",
                                          "layers": {
                                              "0.325": "#ffffff"
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
              },
              "Editable Cluster - large": {
                  "group": "Point layers",
                  "meta": "Retail Points Collector - contains 14,000 records - kmeans",
                  "display": false,
                  "format": "cluster",
                  "dbs": "DEV",
                  "table": "dev.uk_glx_open_retail_points_collector",
                  "qID": "id",
                  "geom": "geom_p_4326",
                  "srid": "4326",
                  "cluster_label": "fascia",
                  "cluster_cat": "retailer",
                  "cluster_kmeans": 0.01,
                  "edit": {
                      "properties": true,
                      "point": true,
                      "delete": true,
                      "geometry": true
                  },
                  "infoj": [
                      {
                          "type": "key"
                      },
                      {
                          "field": "retailer",
                          "label": "Retailer",
                          "inline": true,
                          "edit": true,
                          "filter": "like"
                      },
                      {
                          "field": "fascia",
                          "label": "Fascia",
                          "inline": true,
                          "edit": true
                      },
                      {
                          "field": "store_name",
                          "label": "Name",
                          "inline": true,
                          "edit": true
                      },
                      {
                          "label": "Address",
                          "type": "label"
                      },
                      {
                          "field": "add_one",
                          "edit": true
                      },
                      {
                          "field": "add_two",
                          "edit": true
                      },
                      {
                          "field": "locality",
                          "edit": true
                      },
                      {
                          "field": "postcode",
                          "edit": true
                      },
                      {
                          "field": "town",
                          "edit": true
                      },
                      {
                          "field": "store_type",
                          "label": "Store Type",
                          "filter": {
                              "in": [
                                  "Convenience",
                                  "Small Supermarket",
                                  "Medium Supermarket",
                                  "Large Supermarket"
                              ]
                          },
                          "inline": true,
                          "edit": {
                              "options": [
                                  "Convenience",
                                  "Small Supermarket",
                                  "Medium Supermarket",
                                  "Large Supermarket"
                              ]
                          }
                      },
                      {
                          "field": "size_sqft",
                          "label": "Size in sqft",
                          "inline": true,
                          "edit": {
                              "options": [
                                  "<3kfs",
                                  "3-15kfs",
                                  "15-30kfs",
                                  "30kfs+"
                              ]
                          }
                      },
                      {
                          "field": "pqi",
                          "label": "PQI",
                          "edit": true
                      },
                      {
                          "label": "Images",
                          "field": "images",
                          "type": "images",
                          "edit": true
                      },
                      {
                          "label": "Comments",
                          "field": "comments",
                          "type": "text",
                          "edit": true
                      }
                  ],
                  "style": {
                      "marker": {
                          "type": "target",
                          "fillColor": "#7EBDC3"
                      },
                      "markerMulti": {
                          "type": "target",
                          "fillColor": "#7EBDC3"
                      },
                      "themes": {
                          "Retailers": {
                              "type": "categorized",
                              "field": "retailer",
                              "other": true,
                              "cat": {
                                  "Aldi": {
                                      "style": {
                                          "fillColor": "#ffbf45",
                                          "layers": {
                                              "0.875": "#fa6f08",
                                              "0.75": "#ef3c11",
                                              "0.625": "#001f79",
                                              "0.5": "#02bee3",
                                              "0.25": "ffffff"
                                          }
                                      }
                                  },
                                  "Asda": {
                                      "style": {
                                          "fillColor": "#83b923",
                                          "layers": {
                                              "0.5": "#ffffff",
                                              "0.375": "#fdb839"
                                          }
                                      }
                                  },
                                  "Booths": {
                                      "style": {
                                          "fillColor": "#a12629",
                                          "layers": {
                                              "0.5": "#ffffff",
                                              "0.375": "#a12629"
                                          }
                                      }
                                  },
                                  "Budgens": {
                                      "style": {
                                          "fillColor": "#EEEEE0",
                                          "layers": {
                                              "0.5": "#679a00",
                                              "0.375": "#cccb01"
                                          }
                                      }
                                  },
                                  "Co-op": {
                                      "label": "The Co-Operative",
                                      "style": {
                                          "fillColor": "#0b1e60",
                                          "layers": {
                                              "0.625": "#ffffff",
                                              "0.5": "#a3d227"
                                          }
                                      }
                                  },
                                  "Costco": {
                                      "style": {
                                          "fillColor": "#005daa",
                                          "layers": {
                                              "0.875": "#ffffff",
                                              "0.625": "#e31837"
                                          }
                                      }
                                  },
                                  "Farmfoods": {
                                      "style": {
                                          "fillColor": "#77a632",
                                          "layers": {
                                              "0.75": "#f7f900",
                                              "0.5": "#ff0000"
                                          }
                                      }
                                  },
                                  "Heron": {
                                      "style": {
                                          "fillColor": "#ffffff",
                                          "layers": {
                                              "0.75": "#313590",
                                              "0.25": "#ffcf00"
                                          }
                                      }
                                  },
                                  "Iceland": {
                                      "style": {
                                          "fillColor": "#ed1b2d",
                                          "layers": {
                                              "0.75": "#f2552b",
                                              "0.5": "#f89128",
                                              "0.25": "#ffffff"
                                          }
                                      }
                                  },
                                  "Lidl": {
                                      "style": {
                                          "fillColor": "#d61408",
                                          "layers": {
                                              "0.875": "#ffe502",
                                              "0.5": "#002d7a",
                                              "0.25": "#d61408"
                                          }
                                      }
                                  },
                                  "Makro": {
                                      "style": {
                                          "fillColor": "#00457a",
                                          "layers": {
                                              "0.325": "#ffe811"
                                          }
                                      }
                                  },
                                  "Marks and Spencer": {
                                      "style": {
                                          "fillColor": "#0a0d10",
                                          "layers": {
                                              "0.5": "#def036",
                                              "0.25": "#0a0d10"
                                          }
                                      }
                                  },
                                  "Morrisons": {
                                      "style": {
                                          "fillColor": "#ffe133",
                                          "layers": {
                                              "0.5": "#00614e"
                                          }
                                      }
                                  },
                                  "Sainsburys": {
                                      "style": {
                                          "fillColor": "#ee8a00",
                                          "layers": {
                                              "0.625": "#ffffff",
                                              "0.325": "#ee8a00"
                                          }
                                      }
                                  },
                                  "Tesco": {
                                      "style": {
                                          "fillColor": "#0055a8",
                                          "layers": {
                                              "0.75": "#ffffff",
                                              "0.325": "#f02f26"
                                          }
                                      }
                                  },
                                  "Waitrose": {
                                      "style": {
                                          "fillColor": "#81ae37",
                                          "layers": {
                                              "0.325": "#ffffff"
                                          }
                                      }
                                  },
                                  "Whole Foods Market": {
                                      "style": {
                                          "fillColor": "#00674b",
                                          "layers": {
                                              "0.875": "#ffffff",
                                              "0.5": "#00674b"
                                          }
                                      }
                                  }
                              }
                          },
                          "Shop Size": {
                              "type": "graduated",
                              "field": "size_sqft",
                              "cat_arr": [
                                  {
                                      "value": "0",
                                      "label": "0 - 3kfs",
                                      "style": {
                                          "fillColor": "#5E0B15"
                                      }
                                  },
                                  {
                                      "value": "3020",
                                      "label": "3 - 15kfs",
                                      "style": {
                                          "fillColor": "#D95D39"
                                      }
                                  },
                                  {
                                      "value": "1510",
                                      "label": "15 - 30kfs",
                                      "style": {
                                          "fillColor": "#028090"
                                      }
                                  },
                                  {
                                      "value": "30500",
                                      "label": "30kfs+",
                                      "style": {
                                          "fillColor": "#98CBB4"
                                      }
                                  }
                              ]
                          }
                      }
                  }
              },
              "Editable Cluster - small": {
                  "group": "Point layers",
                  "display": false,
                  "meta": "Sites - containing a small amount of records and reporting",
                  "edit": {
                      "properties": true,
                      "point": true,
                      "delete": true,
                      "geometry": true
                  },
                  "format": "cluster",
                  "geom": "geom_p_4326",
                  "srid": "4326",
                  "dbs": "DEV",
                  "qID": "id",
                  "table": "dev.uk_dev_sites",
                  "cluster_label": "site_name",
                  "infoj": [
                      {
                          "type": "key",
                          "class": "_report"
                      },
                      {
                          "field": "id",
                          "label": "Site ID",
                          "inline": true
                      },
                      {
                          "field": "site_name",
                          "label": "Site Name",
                          "edit": true,
                          "inline": true
                      },
                      {
                          "field": "site_type",
                          "label": "Site Type",
                          "inline": true,
                          "edit": {
                              "options": [
                                  "New Store",
                                  "Replacement"
                              ]
                          }
                      },
                      {
                          "name": "Custom HERE Catchment (1)",
                          "field": "isoline_custom1",
                          "display": false,
                          "fieldfx": "ST_asGeoJson(isoline_custom1)",
                          "type": "geometry",
                          "edit": {
                              "isoline_here": {
                                  "meta": "isoline_custom1_meta"
                              }
                          },
                          "style": {
                              "strokeColor": "#BB0A21",
                              "fillColor": "#BB0A21",
                              "strokeWidth": 2,
                              "fillOpacity": 0.2
                          }
                      },
                      {
                          "label": "Recent isoline settings",
                          "field": "isoline_custom1_meta"
                      },
                      {
                          "name": "Custom HERE Catchment (2)",
                          "field": "isoline_custom2",
                          "display": false,
                          "fieldfx": "ST_asGeoJson(isoline_custom2)",
                          "type": "geometry",
                          "edit": {
                              "isoline_here": {
                                  "meta": "isoline_custom2_meta"
                              }
                          },
                          "style": {
                              "strokeColor": "#bd630a",
                              "fillColor": "#bd630a",
                              "strokeWidth": 2,
                              "fillOpacity": 0.2
                          }
                      },
                      {
                          "label": "Recent isoline settings",
                          "field": "isoline_custom2_meta"
                      },
                      {
                          "name": "Custom HERE Catchment (3)",
                          "field": "isoline_custom3",
                          "display": false,
                          "fieldfx": "ST_asGeoJson(isoline_custom3)",
                          "type": "geometry",
                          "edit": {
                              "isoline_here": {
                                  "meta": "isoline_custom3_meta"
                              }
                          },
                          "style": {
                              "strokeColor": "#bdbd0a",
                              "fillColor": "#bdbd0a",
                              "strokeWidth": 2,
                              "fillOpacity": 0.2
                          }
                      },
                      {
                          "label": "Recent isoline settings",
                          "field": "isoline_custom3_meta"
                      },
                      {
                          "label": "Available dataviews",
                          "type": "label"
                      },
                      {
                          "type": "tableDefinition",
                          "title": "Population Summary",
                          "display": true,
                          "class": "_report",
                          "target_id": "xyz_fashion_pop",
                          "layout": "fitColumns",
                          "columns": [
                              {
                                  "type": "integer",
                                  "title": "Custom Drivetime 1",
                                  "group": "Population (2011 census)",
                                  "field": "custom1",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom1",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "integer",
                                  "title": "Custom Drivetime 2",
                                  "group": "Population (2011 census)",
                                  "field": "custom2",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom2",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "numeric",
                                  "title": "Custom Drivetime 3",
                                  "group": "Population (2011 census)",
                                  "field": "custom3",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom3",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              }
                          ],
                          "rows": [
                              {
                                  "field": "pop_18",
                                  "fieldfx": "SUM(b.pop_18)",
                                  "title": "Current Population (2018)"
                              },
                              {
                                  "field": "pop_11",
                                  "fieldfx": "SUM(b.pop_11)",
                                  "title": "Population 2011"
                              },
                              {
                                  "field": "pop_growth",
                                  "fieldfx": "SUM(b.pop_18 - b.pop_11) * 100 / SUM(b.pop_11)",
                                  "title": "Population Growth"
                              },
                              
                              {
                                  "field": "male",
                                  "fieldfx": "100*SUM(male) / sum(male + female)",
                                  "title": "% Male"
                              },
                              {
                                  "field": "non_white",
                                  "fieldfx": "100*(SUM(pop_11 - white))/SUM(pop_11)",
                                  "title": "% Non-White"
                              },
                              {
                                  "field": "own_home",
                                  "fieldfx": "100*SUM(dwelling_ownhome)/SUM(dwelling_ownhome+dwelling_socialrented+dwelling_privaterented+dwelling_rentfree)",
                                  "title": "% Own Home"
                              },
                              {
                                  "field": "private_rented",
                                  "fieldfx": "100*SUM(dwelling_privaterented)/SUM(dwelling_ownhome+dwelling_socialrented+dwelling_privaterented+dwelling_rentfree)",
                                  "title": "% Private Rented"
                              },
                              {
                                  "field": "social_rented",
                                  "fieldfx": "100*SUM(dwelling_socialrented)/SUM(dwelling_ownhome+dwelling_socialrented+dwelling_privaterented+dwelling_rentfree)",
                                  "title": "% Social Rented"
                              },{
                                  "field": "rentfree",
                                  "fieldfx": "100*SUM(dwelling_rentfree)/SUM(dwelling_ownhome+dwelling_socialrented+dwelling_privaterented+dwelling_rentfree)",
                                  "title": "% Rent Free"
                              },
                              {
                                  "field": "single_hhds",
                                  "fieldfx": "100*SUM(pers1hhd)/SUM(pers1hhd+pers2hhd+pers2plushhd)",
                                  "title": "% Single Hhds"
                              },
                              {
                                  "field": "hhds_two_ppl",
                                  "fieldfx": "100*SUM(pers2hhd)/SUM(pers1hhd+pers2hhd+pers2plushhd)",
                                  "title": "% 2 Person Hhds"
                              },
                              {
                                  "field": "hhds_3plus",
                                  "fieldfx": "100*SUM(pers2plushhd)/SUM(pers1hhd+pers2hhd+pers2plushhd)",
                                  "title": "% 3+ Hhds"
                              }
                          ]
                      },
                      {
                          "type": "tableDefinition",
                          "title": "Age Profile",
                          "display": true,
                          "target_id": "xyz_sites_age",
                          "columns": [
                              {
                                  "type": "integer",
                                  "title": "Custom Drivetime 1",
                                  "group": "Population (2011 census)",
                                  "field": "custom1",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom1",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "integer",
                                  "title": "Custom Drivetime 2",
                                  "group": "Population (2011 census)",
                                  "field": "custom2",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom2",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "numeric",
                                  "title": "Custom Drivetime 3",
                                  "group": "Population (2011 census)",
                                  "field": "custom3",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom3",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "numeric",
                                  "field": "uk",
                                  "aspatial": "age0to18, age18to24, age25to44, age45to59, age60plus, age_profile_total FROM geodata.uk_glx_geodata_demographics_uk_regions where region = 'UK_avg'"
                              }
                          ],
                          "rows": [
                              {
                                  "field": "age0to18",
                                  "title": "< 18",
                                  "fieldfx": "ROUND(SUM(b.age0to18::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "age18to24",
                                  "title": "18 to 24",
                                  "fieldfx": "ROUND(SUM(b.age18to24::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "age25to44",
                                  "title": "25 to 44",
                                  "fieldfx": "ROUND(SUM(b.age25to44::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "age45to59",
                                  "title": "45 to 59",
                                  "fieldfx": "ROUND(SUM(b.age45to59::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "age60plus",
                                  "title": "60+",
                                  "fieldfx": "ROUND(SUM(b.age60plus::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "age_profile_total",
                                  "title": "Total",
                                  "fieldfx": "ROUND(SUM(b.pop_11::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              }
                          ],
                          "agg": {
                              "share15": {
                                  "title": "% with drivetime 3",
                                  "rows": [
                                      "100*custom3.age0to18/custom3.age_profile_total",
                                      "100*custom3.age18to24/custom3.age_profile_total",
                                      "100*custom3.age25to44/custom3.age_profile_total",
                                      "100*custom3.age45to59/custom3.age_profile_total",
                                      "100*custom3.age60plus/custom3.age_profile_total"
                                  ],
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 1
                                  }
                              },
                              "age_uk_total": {
                                  "title": "UK %",
                                  "rows": [
                                      "uk.age0to18*100/uk.age_profile_total",
                                      "uk.age18to24*100/uk.age_profile_total",
                                      "uk.age25to44*100/uk.age_profile_total",
                                      "uk.age45to59*100/uk.age_profile_total",
                                      "uk.age60plus*100/uk.age_profile_total"
                                  ],
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 1
                                  }
                              },
                              "age_under_indexer": {
                                  "title": "Under",
                                  "group": "Index",
                                  "type": "integer",
                                  "align": "right",
                                  "formatter": "progress",
                                  "formatterParams": {
                                      "color": [
                                          "#C0392B"
                                      ],
                                      "min": 0,
                                      "max": 200
                                  },
                                  "width": 150,
                                  "sorter": "number",
                                  "rows": [
                                      "case when uk.age_profile_total*(100*custom3.age0to18/custom3.age_profile_total)/uk.age0to18 < 100 then 100 - uk.age_profile_total*(100*custom3.age0to18/custom3.age_profile_total)/uk.age0to18 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age18to24/custom3.age_profile_total)/uk.age18to24 < 100 then 100 - uk.age_profile_total*(100*custom3.age18to24/custom3.age_profile_total)/uk.age18to24 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age25to44/custom3.age_profile_total)/uk.age25to44 < 100 then 100 - uk.age_profile_total*(100*custom3.age25to44/custom3.age_profile_total)/uk.age25to44 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age45to59/custom3.age_profile_total)/uk.age45to59 < 100 then 100 - uk.age_profile_total*(100*custom3.age45to59/custom3.age_profile_total)/uk.age45to59 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age60plus/custom3.age_profile_total)/uk.age60plus < 100 then 100 - uk.age_profile_total*(100*custom3.age60plus/custom3.age_profile_total)/uk.age60plus else 0 end"
                                  ]
                              },
                              "age_over_indexer": {
                                  "title": "Over",
                                  "group": "Index",
                                  "type": "integer",
                                  "align": "left",
                                  "formatter": "progress",
                                  "formatterParams": {
                                      "color": [
                                          "#16A085"
                                      ],
                                      "min": 0,
                                      "max": 200
                                  },
                                  "width": 150,
                                  "sorter": "number",
                                  "rows": [
                                      "case when uk.age_profile_total*(100*custom3.age0to18/custom3.age_profile_total)/uk.age0to18 >= 100 then (uk.age_profile_total*(100*custom3.age0to18/custom3.age_profile_total)/uk.age0to18) - 100 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age18to24/custom3.age_profile_total)/uk.age18to24 >= 100 then (uk.age_profile_total*(100*custom3.age18to24/custom3.age_profile_total)/uk.age18to24) - 100 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age25to44/custom3.age_profile_total)/uk.age25to44 >= 100 then (uk.age_profile_total*(100*custom3.age25to44/custom3.age_profile_total)/uk.age25to44) - 100 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age45to59/custom3.age_profile_total)/uk.age45to59 >= 100 then (uk.age_profile_total*(100*custom3.age45to59/custom3.age_profile_total)/uk.age45to59) - 100 else 0 end",
                                      "case when uk.age_profile_total*(100*custom3.age60plus/custom3.age_profile_total)/uk.age60plus >= 100 then (uk.age_profile_total*(100*custom3.age60plus/custom3.age_profile_total)/uk.age60plus) - 100 else 0 end"
                                  ]
                              },
                              "age_index_value": {
                                  "title": "Score",
                                  "group": "Index",
                                  "type": "integer",
                                  "align": "center",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  },
                                  "width": 100,
                                  "sorter": "number",
                                  "rows": [
                                      "uk.age_profile_total*(100*custom3.age0to18/custom3.age_profile_total)/uk.age0to18",
                                      "uk.age_profile_total*(100*custom3.age18to24/custom3.age_profile_total)/uk.age18to24",
                                      "uk.age_profile_total*(100*custom3.age25to44/custom3.age_profile_total)/uk.age25to44",
                                      "uk.age_profile_total*(100*custom3.age45to59/custom3.age_profile_total)/uk.age45to59",
                                      "uk.age_profile_total*(100*custom3.age60plus/custom3.age_profile_total)/uk.age60plus"
                                  ]
                              }
                          }
                      },
                      {
                          "type": "tableDefinition",
                          "title": "Social Grade",
                          "display": true,
                          "target_id": "xyz_sites_social",
                          "columns": [
                              {
                                  "type": "integer",
                                  "title": "Custom Drivetime 1",
                                  "group": "Households",
                                  "field": "custom1",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom1",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "integer",
                                  "title": "Custom Drivetime 2",
                                  "group": "Households",
                                  "field": "custom2",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom2",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "numeric",
                                  "title": "Custom Drivetime 3",
                                  "group": "Households",
                                  "field": "custom3",
                                  "lookup": {
                                      "table_a": "dev.uk_dev_sites",
                                      "table_b": "geodata.uk_glx_geodata_oa_metrics",
                                      "geom_a": "isoline_custom3",
                                      "geom_b": "geom_4326_5m"
                                  },
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "type": "numeric",
                                  "field": "uk",
                                  "aspatial": "sg_ab, sg_c1, sg_c2, sg_de, sg_total FROM geodata.uk_glx_geodata_demographics_uk_regions where region = 'UK_avg'"
                              }
                          ],
                          "rows": [
                              {
                                  "field": "sg_ab",
                                  "title": "AB",
                                  "fieldfx": "ROUND(SUM(b.abhrp::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "sg_c1",
                                  "title": "C1",
                                  "fieldfx": "ROUND(SUM(b.c1hrp::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "sg_c2",
                                  "title": "C2",
                                  "fieldfx": "ROUND(SUM(b.c2hrp::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "sg_de",
                                  "title": "DE",
                                  "fieldfx": "ROUND(SUM(b.dehrp::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              },
                              {
                                  "field": "sg_total",
                                  "title": "Total",
                                  "fieldfx": "ROUND(SUM((b.abhrp+b.c1hrp+b.c2hrp+b.dehrp)::NUMERIC * ST_Area(ST_Intersection(a.isoline_custom1, b.geom_4326_5m)::geography)/ST_Area(b.geom_4326_5m::geography)))::INT"
                              }
                          ],
                          "agg": {
                              "share15": {
                                  "title": "% with drivetime 3",
                                  "rows": [
                                      "100*custom3.sg_ab/custom3.sg_total",
                                      "100*custom3.sg_c1/custom3.sg_total",
                                      "100*custom3.sg_c2/custom3.sg_total",
                                      "100*custom3.sg_de/custom3.sg_total"
                                  ],
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 1
                                  }
                              },
                              "sg_uk_total": {
                                  "title": "UK %",
                                  "rows": [
                                      "uk.sg_ab*100/uk.sg_total",
                                      "uk.sg_c1*100/uk.sg_total",
                                      "uk.sg_c2*100/uk.sg_total",
                                      "uk.sg_de*100/uk.sg_total"
                                  ],
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 1
                                  }
                              },
                              "sg_under_indexer": {
                                  "title": "Under",
                                  "group": "Index",
                                  "type": "integer",
                                  "align": "right",
                                  "formatter": "progress",
                                  "formatterParams": {
                                      "color": [
                                          "#C0392B"
                                      ],
                                      "min": 0,
                                      "max": 200
                                  },
                                  "width": 150,
                                  "sorter": "number",
                                  "rows": [
                                      "case when uk.sg_total*(100*custom3.sg_ab/custom3.sg_total)/uk.sg_ab < 100 then 100 - uk.sg_total*(100*custom3.sg_ab/custom3.sg_total)/uk.sg_ab else 0 end",
                                      "case when uk.sg_total*(100*custom3.sg_c1/custom3.sg_total)/uk.sg_c1 < 100 then 100 - uk.sg_total*(100*custom3.sg_c1/custom3.sg_total)/uk.sg_c1 else 0 end",
                                      "case when uk.sg_total*(100*custom3.sg_c2/custom3.sg_total)/uk.sg_c2 < 100 then 100 - uk.sg_total*(100*custom3.sg_c2/custom3.sg_total)/uk.sg_c2 else 0 end",
                                      "case when uk.sg_total*(100*custom3.sg_de/custom3.sg_total)/uk.sg_de < 100 then 100 - uk.sg_total*(100*custom3.sg_de/custom3.sg_total)/uk.sg_de else 0 end"
                                  ]
                              },
                              "sg_over_indexer": {
                                  "title": "Over",
                                  "group": "Index",
                                  "type": "integer",
                                  "align": "left",
                                  "formatter": "progress",
                                  "formatterParams": {
                                      "color": [
                                          "#16A085"
                                      ],
                                      "min": 0,
                                      "max": 200
                                  },
                                  "width": 150,
                                  "sorter": "number",
                                  "rows": [
                                      "case when uk.sg_total*(100*custom3.sg_ab/custom3.sg_total)/uk.sg_ab >= 100 then (uk.sg_total*(100*custom3.sg_ab/custom3.sg_total)/uk.sg_ab) - 100 else 0 end",
                                      "case when uk.sg_total*(100*custom3.sg_c1/custom3.sg_total)/uk.sg_c1 >= 100 then (uk.sg_total*(100*custom3.sg_c1/custom3.sg_total)/uk.sg_c1) - 100 else 0 end",
                                      "case when uk.sg_total*(100*custom3.sg_c2/custom3.sg_total)/uk.sg_c2 >= 100 then (uk.sg_total*(100*custom3.sg_c2/custom3.sg_total)/uk.sg_c2) - 100 else 0 end",
                                      "case when uk.sg_total*(100*custom3.sg_de/custom3.sg_total)/uk.sg_de >= 100 then (uk.sg_total*(100*custom3.sg_de/custom3.sg_total)/uk.sg_de) - 100 else 0 end"
                                  ]
                              },
                              "sg_index_value": {
                                  "title": "Score",
                                  "group": "Index",
                                  "type": "integer",
                                  "align": "center",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  },
                                  "width": 100,
                                  "sorter": "number",
                                  "rows": [
                                      "uk.sg_total*(100*custom3.sg_ab/custom3.sg_total)/uk.sg_ab",
                                      "uk.sg_total*(100*custom3.sg_c1/custom3.sg_total)/uk.sg_c1",
                                      "uk.sg_total*(100*custom3.sg_c2/custom3.sg_total)/uk.sg_c2",
                                      "uk.sg_total*(100*custom3.sg_de/custom3.sg_total)/uk.sg_de"
                                      
                                  ]
                              }
                          }
                      }
                  ],
                  "style": {
                      "hidden": true,
                      "marker": {
                          "type": "target",
                          "fillColor": "#2364AA",
                          "layers": {
                              "0.75": "#EEE",
                              "0.50": "#2364AA"
                          }
                      },
                      "markerMulti": {
                          "type": "target",
                          "fillColor": "#2364AA",
                          "layers": {
                              "0.75": "#EEE",
                              "0.50": "#2364AA"
                          }
                      }
                  }
              },
              "Postal": {
                  "group": "Vector layers",
                  "dbs": "DEV",
                  "geom": "geom_3857",
                  "srid": "3857",
                  "qID": "id",
                  "format": "mvt",
                  "mvt_cache": "dev.x_mvts_uk_glx_open_postal",
                  "tables": {
                      "5": null,
                      "6": "geodata.uk_glx_open_postal_area",
                      "7": "geodata.uk_glx_open_postal_area",
                      "8": "geodata.uk_glx_open_postal_district",
                      "9": "geodata.uk_glx_open_postal_district",
                      "10": "geodata.uk_glx_open_postal_sector",
                      "11": "geodata.uk_glx_open_postal_sector",
                      "12": "geodata.uk_glx_open_postal_sector",
                      "13": null
                  },
                  "infoj": [
                      {
                          "type": "key"
                      },
                      {
                          "field": "area_name",
                          "label": "Area Name",
                          "inline": true
                      },
                      {
                          "field": "postal_area",
                          "label": "Postal Area",
                          "inline": true
                      },
                      {
                          "field": "postal_district",
                          "label": "Postal District",
                          "inline": true
                      },
                      {
                          "field": "postal_sector",
                          "label": "Postal Sector",
                          "inline": true
                      },
                      {
                          "field": "postcode_count",
                          "label": "Number of Postcodes",
                          "type": "integer",
                          "inline": true
                      }
                  ],
                  "style": {
                      "default": {
                          "strokeColor": "#7a0177"
                      },
                      "highlight": {
                          "strokeColor": "#090",
                          "fillColor": "#090",
                          "fillOpacity": 0.3
                      }
                  }
              },
              "Retail Places": {
                  "format": "mvt",
                  "group": "Vector layers",
                  "dbs": "DEV",
                  "qID": "id",
                  "tables": {
                      "8": null,
                      "9": "geodata.uk_glx_open_retail_place"
                  },
                  "geom": "geom_3857",
                  "srid": "3857",
                  "mvt_cache": "dev.x_mvtx_uk_glx_open_retail_place",
                  "dataview": {
                      "Retail Places": {
                          "viewport": true,
                          "display": true,
                          "from": "geodata.uk_glx_open_retail_place",
                          "layout": "fitColumns",
                          "columns": [
                              {
                                  "title": "ID",
                                  "field": "id"
                              },
                              {
                                  "field": "rpname",
                                  "title": "Name"
                              },
                              {
                                  "field": "rptype",
                                  "title": "Type"
                              },
                              {
                                  "field": "strength",
                                  "title": "Competition strength",
                                  "group": "Characteristics",
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              },
                              {
                                  "field": "estunit",
                                  "title": "Estimate units",
                                  "group": "Characteristics",
                                  "align": "right",
                                  "formatter": "money",
                                  "formatterParams": {
                                      "precision": 0
                                  }
                              }
                          ]
                      }
                  },
                  "style": {
                      "label": {
                          "field": "rpname"
                      },
                      "default": {
                          "strokeWidth": 1,
                          "strokeColor": "#ffff66",
                          "opacity": 1,
                          "fillColor": "#ffff66",
                          "fillOpacity": 0.7
                      },
                      "highlight": {
                          "strokeColor": "#e91e63",
                          "fillOpacity": 0.3
                      },
                      "themes": {
                          "Retail Place Type": {
                              "type": "categorized",
                              "field": "rptype",
                              "other": true,
                              "cat": {
                                  "Major City Centre": {
                                      "style": {
                                          "strokeColor": "#6e016b",
                                          "fillColor": "#6e016b"
                                      }
                                  },
                                  "City Centre": {
                                      "style": {
                                          "strokeColor": "#88419d",
                                          "fillColor": "#88419d"
                                      }
                                  },
                                  "Large Town Centre": {
                                      "style": {
                                          "strokeColor": "#8c6bb1",
                                          "fillColor": "#8c6bb1"
                                      }
                                  },
                                  "Major Urban Centre": {
                                      "style": {
                                          "strokeColor": "#8c96c6",
                                          "fillColor": "#8c96c6"
                                      }
                                  },
                                  "Regional SC": {
                                      "style": {
                                          "strokeColor": "#016450",
                                          "fillColor": "#016450"
                                      }
                                  },
                                  "Retail Park": {
                                      "style": {
                                          "strokeColor": "#02818a",
                                          "fillColor": "#02818a"
                                      }
                                  },
                                  "Outlet Centre": {
                                      "style": {
                                          "strokeColor": "#3690c0",
                                          "fillColor": "#3690c0"
                                      }
                                  }
                              }
                          },
                          "Leisure %": {
                              "type": "graduated",
                              "field": "leisure_pct",
                              "cat_arr": [
                                  {
                                      "value": 0,
                                      "label": "Less than 10%",
                                      "style": {
                                          "strokeColor": "#ffffcc",
                                          "fillColor": "#ffffcc"
                                      }
                                  },
                                  {
                                      "value": 0.1,
                                      "label": "10 to 20%",
                                      "style": {
                                          "strokeColor": "#c2e699",
                                          "fillColor": "#c2e699"
                                      }
                                  },
                                  {
                                      "value": 0.2,
                                      "label": "20 to 30%",
                                      "style": {
                                          "strokeColor": "#78c679",
                                          "fillColor": "#78c679"
                                      }
                                  },
                                  {
                                      "value": 0.3,
                                      "label": "30 to 50%",
                                      "style": {
                                          "strokeColor": "#31a354",
                                          "fillColor": "#31a354"
                                      }
                                  },
                                  {
                                      "value": 0.5,
                                      "label": "Over 50%",
                                      "style": {
                                          "strokeColor": "#006837",
                                          "fillColor": "#006837"
                                      }
                                  }
                              ]
                          }
                      }
                  },
                  "filter": {
                      "infoj": [
                          {
                              "label": "ID count",
                              "field": "id_count",
                              "type": "integer",
                              "inline": true,
                              "fieldfx": "count(id)"
                          }
                      ]
                  },
                  "infoj": [
                      {
                          "type": "key"
                      },
                      {
                          "label": "ID",
                          "field": "id",
                          "inline": true
                      },
                      {
                          "label": "RP Type",
                          "field": "rptype",
                          "type": "text",
                          "filter": {
                              "in": [
                                  "Major City Centre",
                                  "City Centre",
                                  "Large Town Centre",
                                  "Major Urban Centre",
                                  "Regional SC",
                                  "Outlet Centre",
                                  "Retail Park"
                              ]
                          }
                      },
                      {
                          "label": "Name",
                          "field": "rpname",
                          "inline": true
                      },
                      {
                          "label": "Competition Str.",
                          "field": "strength",
                          "type": "integer",
                          "inline": true
                      },
                      {
                          "label": "Profile",
                          "type": "group",
                          "expanded": true,
                          "chart": {
                              "type": "horizontalBar",
                              "backgroundColor": [
                                  "#FFA630",
                                  "#C6DEA6",
                                  "#7EBDC3",
                                  "#7A6263",
                                  "#CED097"
                              ],
                              "borderColor": [
                                  "#FFA630",
                                  "#C6DEA6",
                                  "#7EBDC3",
                                  "#7A6263",
                                  "#CED097"
                              ]
                          }
                      },
                      {
                          "group": "Profile",
                          "label": "Comp",
                          "field": "comp_pct",
                          "type": "numeric"
                      },
                      {
                          "group": "Profile",
                          "label": "Conv",
                          "field": "conv_pct",
                          "type": "numeric"
                      },
                      {
                          "group": "Profile",
                          "label": "Leisure",
                          "field": "leisure_pct",
                          "type": "numeric"
                      },
                      {
                          "group": "Profile",
                          "label": "Home",
                          "field": "home_pct",
                          "type": "numeric"
                      },
                      {
                          "group": "Profile",
                          "label": "Services",
                          "field": "service_pct",
                          "type": "numeric"
                      }
                  ]
              },
              "Free Draw / Selection Tool": {
                  "meta": "Test layer for editing and drawing geometries.",
                  "format": "mvt",
                  "group": "Vector layers",
                  "dbs": "DEV",
                  "table": "dev.uk_dev_scratch",
                  "srid": "3857",
                  "geom": "geom_3857",
                  "mvt_cache": "dev.x_mvts_uk_dev_scratch",
                  "qID": "id",
                  "edit": {
                      "polygon": true,
                      "freehand": true,
                      "circle": true,
                      "rectangle": true,
                      "line": true,
                      "isoline_mapbox": true,
                      "isoline_here": true,
                      "delete": true
                  },
                  "infoj": [
                      {
                          "type": "key"
                      },
                      {
                          "label": "ID",
                          "field": "id",
                          "inline": true
                      },
                      {
                          "label": "Area Name",
                          "field": "area_name",
                          "edit": true,
                          "inline": true
                      },
                      {
                          "label": "Description",
                          "field": "description",
                          "edit": true
                      },
                      {
                          "label": "Number of Food Stores",
                          "field": "_store_count",
                          "fieldfx": "(SELECT sum(1) FROM dev.uk_dev_scratch a, dev.uk_glx_open_retail_points_food_stores b  WHERE st_intersects(st_transform(a.geom_3857, 4326), b.geom_p_4326) AND a.id =$1)",
                          "inline": true
                      },
                      {
                          "label": "Date last edited",
                          "field": "edited",
                          "type": "date",
                          "inline": true
                      }
                  ],
                  "style": {
                      "hidden": true,
                      "default": {
                          "strokeColor": "#083D77",
                          "fillColor": "#083D77",
                          "fillOpacity": 0.3,
                          "marker": {
                              "type": "circle",
                              "strokeColor": "#083D77"
                          },
                          "_marker": {
                              "url": "https://cdn.jsdelivr.net/gh/GEOLYTIX/gla/icon-pin.svg",
                              "anchor": [
                                  0.5,
                                  1
                              ]
                          }
                      },
                      "highlight": {
                          "strokeColor": "#F78764",
                          "fillColor": "#F78764",
                          "fillOpacity": 0.3,
                          "marker": {
                              "type": "dot",
                              "fillColor": "#F78764",
                              "scale": 0.05
                          }
                      }
                  }
              }
          }
      }
  }
}